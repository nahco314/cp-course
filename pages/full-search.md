# 全探索

- 全探索とは: あり得る全パターンを調べ上げる

---

# 全探索

- ちょうどいい問題が二次予選に出てたので、これを例題に採用します

<img src="/img.png"/>

---

# 全探索 - JOI 二次予選 A

- これを素朴な全探索で解いてみる

<v-click>

+ 3 枚のカードの選び方を全通り試してみて、その 3 枚が条件を満たすか判定する
  - 1 枚目が 1...N 枚目で、
    - 2 枚目が 1...N 枚目で、
      - 3 枚目が 1...N 枚目のとき、
        - 1 枚目 + 3 = 2 枚目かつ 2 枚目 + 3 = 3 枚目かを判定

</v-click>

<v-click>

- N 回のループを 3 重で回すので、計算量は O(N^3)

</v-click>

---

# 全探索 - JOI 二次予選 A

- これを素朴な全探索で解いてみる

+ O(N^3) の全探索で、この問題の 70 点分の部分点は取れる
  - JOI だと部分点がめっちゃ大事！

- N がある程度大きいと、O(N^3) は時間がかかりすぎて TLE に

---

# 全探索 - JOI 二次予選 A

- この問題の満点を取るには...？

<ul>

<li v-click="1">
実は、全探索にもいくつか種類がある
</li><li v-click="2">
O(N^3) のやつみたいな、マジで全パターン試すタイプ
</li><li v-click="3">
なにかの工夫をして、考えるべきパターンを減らすタイプ
</li>

</ul>

---

# 全探索 - JOI 二次予選 A

- 3 枚のカードの選び方を全通り試してみて、その 3 枚が条件を満たすか判定する
  - 1 枚目が 1...N 枚目で、
    - 2 枚目が 1...N 枚目で、
      - 3 枚目が 1...N 枚目のとき、
        - 1 枚目 + 3 = 2 枚目かつ 2 枚目 + 3 = 3 枚目かを判定

<v-click>

+ これ、1 枚目を決定したときに、2 枚目と 3 枚目にどういうカードを選ばなきゃいけないかは確定する

</v-click>

---

# 全探索 - JOI 二次予選 A

- 1 枚目に書かれている整数が k のとき、2 枚目には k+3、3 枚目には k+6 が書かれている必要がある

<v-click>

+ ある整数 m が書かれたカードが存在するかというのは、bool 配列を事前に用意しておけば高速に判定できる
  - `lst[m] := m が書かれたカードが存在するなら true`

</v-click>

---

# 全探索 - JOI 二次予選 A

- 1 枚目のカードを全探索し、それに基づいて k+3 と k+6 が書かれたカードが存在するかを判定

<v-click>

+ →探索するパターン数を N^3 個から N 個に減らせた！

</v-click>
<v-click>

- このアルゴリズムは O(N) で、満点が取れる

</v-click>

---

# 全探索 - JOI 二次予選 A

- https://atcoder.jp/contests/joi2024yo2/submissions/48459994

<center>

```cpp
int main() {
    int n;
    cin >> n;
    vector<int> a(n);
    for (int i = 0; i < n; i++) {
        cin >> a[i];
    }

    vector<bool> is_exists(200001, false);
    for (int i = 0; i < n; i++) {
        is_exists[a[i]] = true;
    }

    for (int i = 0; i < n; i++) {
        if (is_exists[a[i] + 3] && is_exists[a[i] + 6]) {
            cout << "Yes" << endl;
            exit(0);
        }
    }

    cout << "No" << endl;
}
```

</center>

<style>

.slidev-code code {
  font-size: 10px  !important;
}

pre[class*='language-'] {
  width: 700px;
}

</style>
